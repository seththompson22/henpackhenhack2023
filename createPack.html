<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" type="text/css" href="./styles/createPack.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">


	<title>Create Your Hen Pack</title>
</head>
<body>
    <div class="content">
        <h1 class="title">Create Your Hen Pack</h1>
        <div class="container-group">
            <div id="containerB">
                <label for="email">Enter email:</label>
                <input type="email" id="email" name="email" placeholder="johndoe@gmail.com">
                <button type="button" onclick="addEmail()">Add Email</button>
            </div>
            <div id="container">
                <label for="group-name">Group Name:</label>
                <input type="text" id="group-name" name="group-name" placeholder="DoeADeer">
                <button type="button" onclick="createGroup()">Create Pack</button>
            </div>
        </div>
        <div id="buttonContainer">
            <button id="email-button" type="button" onclick="directGroup()">Find your Times!</button>
            <label id="email-button-counter" for="email-button-counter"></label>
        </div>

        <script>

            // Define an array to store the emails
            var emails = [];

            // Function to add an email to the array
            function addEmail() {
                var email = document.getElementById("email").value;
                
                if (validateEmail(email)) {
                    if (!emails.includes(email)){
                        emails.push(email);
                        document.getElementById("email").value = "";
                        updateGroup();
                    }
                    else {
                        alert("Email already Entered")
                    }
                } else {
                    alert("Please enter a valid email address.");
                }
            }

            // Function to create the group
            function createGroup() {
                var groupName = document.getElementById("group-name").value;
                if (groupName === "") {
                    alert("Please enter a group name.");
                } else if (emails.length === 0) {
                    alert("Please add at least one email to the group.");
                } else {
                    var groupList = document.createElement("ul");
                    groupList.setAttribute('id','email-list');
                    for (var i = 0; i < emails.length; i++) {
                        var emailListItem = document.createElement("li");
                        emailListItem.textContent = emails[i];
                        emailListItem.setAttribute('id','emailListItem');
                        groupList.appendChild(emailListItem);
                    }
                    document.getElementById("group").innerHTML = "";
                    document.getElementById("group").appendChild(groupList);
                    alert("Group \"" + groupName + "\" created with " + emails.length + " members.");
                }
            }

            // Function to validate an email address
            function validateEmail(email) {
                var regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                return regex.test(email);
            }

            // Function to update the group display
            function updateGroup() {
                var groupList = document.createElement("ul");
                var uniqueEmails = [];

                var emailContainer = document.getElementById("containerB");

                // Remove previous ul element
                var previousList = document.getElementById("email-list");
                if (previousList) {
                    previousList.remove();
                }

                for (var j = 0; j < emails.length; j++) {
                    if (!uniqueEmails.includes(emails[j])) {
                        uniqueEmails.push(emails[j]);
                        var emailListItem = document.createElement("li");
                        emailListItem.textContent = emails[j];
                        emailListItem.setAttribute('id', 'emailListItem');
                        groupList.appendChild(emailListItem);
                    } else {
                        groupList.removeChild(document.getElementById("emailListItem"));
                    }
                }

                groupList.setAttribute('id', 'email-list');
                emailContainer.appendChild(groupList);
            }
            

            function directGroup(emails){
                window.location.href = "https://seththompson22.github.io/henpackhenhack2023/update_schedule.html";
            }
            
            var start_char = document.getElementById('');

            export { groupName, emails };
        </script>
        <script src="structure.js"></script>
    </div>
</body>
</html>